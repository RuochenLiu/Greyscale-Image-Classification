---
title: "Project 3"
author: "Nikita Bondarenko, Yue Gao, Ruochen Liu, Xuehan Liu, Xiaowo Sun"
date: "March 24, 2017"
output:
  pdf_document: default
  html_document: default
---

Group Member:
Nikita Bondarenko, Yue Gao, Ruochen Liu, Xuehan Liu, Xiaowo Sun


### Step 0: load libraries and specify directories
```{r}
library("caret")
library("gbm")
library("randomForest")
library("plyr")
library("xgboost")
library("fastAdaboost")
library("deepboost")
library("EBImage")
library("e1071")
library("kernlab")
library("OpenImageR")
```


```{r wkdir, eval=FALSE}
setwd("~/GitHub/spr2017-proj3-group7/doc/") 
source("../lib/feature.R")
source("../lib/train.R")
source("../lib/test.R")
# here replace it with your own path or manually set it in RStudio to where this rmd file is located. 
```

Provide directories for raw images. Training set and test set should be in different subfolders. 
```{r}
experiment_dir <- "../data/" # This will be modified for different data sets.
img_train_dir <- paste(experiment_dir, "raw_images/", sep="")
img_test_dir <- paste(experiment_dir, "raw_images/", sep="")
```

###Step 1: Summary of trained models

####baseline model

GBM + 5000SIFT
```{r}
load("../output/baseline.RData")
print(baseline$bestTune)
print(mean(baseline$finalModel$train.error))
```

####other models that we have tried using HOG features
Test Errors:
GBM: 0.146
Random Forest:0.142
SVM Linear: 0.122
SVM Radial: 0.118
xgBoost: 0.136
DeepBoost: 0.15

####advanced model

Finally we decided to use SVM Linear model because of its low test error and stability.
```{r}
#load SVM here
load("../output/advanced.RData")
print(advanced$bestTune)
print(advanced$finalModel)
```

### Step 2: Extract new features from test images

For our project, we construct 54 HOG features. Save the constructed features to the output subfolder.
```{r}

tm_feature_test <- system.time(feature_test <-feature(img_test_dir,export=T))
#load("../output/HOG.RData")

```

### Step 3: Make prediction 

####baseline model

Only feed the baseline training model with SIFT data. 
```{r}
tm_test_bs <- system.time(pred_test_bs <- Test(baseline, feature_test))
save(pred_test_bs, file="../output/pred_test_bs.RData")
```

####advanced model

Only feed the advanced training model with HOG data.
```{r}
tm_test_ad <- system.time(pred_test_ad <- Test(advanced, feature_test))
save(pred_test_ad, file="../output/pred_test_ad.RData")
``` 

### Step 4: Summarize Running Time

```{r}
cat("Time for constructing testing features=", tm_feature_test[1], "s \n")
cat("Time for making prediction=", tm_test_ad[1], "s \n")
```

